

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Stimulus &mdash; atlab-docs 0.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'0.0.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="DataJoint" href="datajoint.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> atlab-docs
          

          
          </a>

          
            
            
              <div class="version">
                0.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="datajoint.html">DataJoint</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stimulus</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitor-requirements">Monitor Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#software-requirements">Software Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-run-existing-stimulus">How to run existing stimulus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-initialize-screen">Step 1: Initialize screen</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-generate-stimulus-conditions-and-queue-trials">Step 2: Generate stimulus conditions and queue trials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-run-the-stimulus">Step 3. Run the stimulus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-interrupt-and-resume-the-stimulus">Step 4. Interrupt and resume the stimulus</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-exit">Step 5. Exit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stimulus-repository-structure">Stimulus Repository Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#designing-a-new-stimulus">Designing a New Stimulus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stimulus-display">Stimulus Display</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stimulus-configuration">Stimulus Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imagenet-v2">imagenet_v2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-resources">Other Resources:</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">atlab-docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Stimulus</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stimulus.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="stimulus">
<h1>Stimulus<a class="headerlink" href="#stimulus" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The stimulus schema is a self-contained application that generates, presents, and records visual stimuli using PsychToolbox.</p>
</div>
<div class="section" id="monitor-requirements">
<h2>Monitor Requirements<a class="headerlink" href="#monitor-requirements" title="Permalink to this headline">¶</a></h2>
<p>In order to view the stimulus, one needs 2 monitors at minimum while setting one of the monitors’ xscreen number <em>higher</em> than the other (e.g. xscreen 0 for monitor 1 and xscreen 1 for monitor 2.)
This process can be tricky depending on how you initially installed your monitors and set up your xscreens.</p>
<p>If you have a GPU on your machine, one way to check whether you have 2 xscreens is simply checking <strong>Nvidia X Server Settings</strong></p>
<a class="reference internal image-reference" href="_images/xscreen.jpg"><img alt="_images/xscreen.jpg" class="align-center" src="_images/xscreen.jpg" style="width: 400.0px; height: 200.0px;" /></a>
<p>As you can see above, there are 2 x Screens set up.</p>
<p>It is best to consult with Chris Turner or Saumil Patel to configure xscreens.</p>
</div>
<div class="section" id="software-requirements">
<h2>Software Requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline">¶</a></h2>
<p>Stimulus package is written in MATLAB, thus all the packages required below must be <em>known</em> to MATLAB environment.</p>
<p><span class="raw-html"><font color="red"><strong>MATLAB (MUST BE R2016b or above)</strong></font></span></p>
<ul class="simple">
<li><a class="reference external" href="http://psychtoolbox.org/download.html#installation">PsychToolbox</a> : Stimulus package uses PsychToolbox as a backend</li>
<li><a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/63218-datajoint">datajoint</a> : It is best to simply install via <em>Add On</em> on MATLAB console</li>
</ul>
<p>Following packages must be cloned and added to <em>PATH</em> of the MATLAB</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/datajoint/mym.git">mym</a> : datajoint extension to recognize data type <em>BLOB</em></li>
<li><a class="reference external" href="https://github.com/cajal/pipeline.git">pipeline</a> : need to be able to access <em>experiment</em> module</li>
<li><a class="reference external" href="https://github.com/cajal/stimuli.git">stimulus</a> : stimulus package itself</li>
</ul>
<p>In order to make add these packages to <strong>PATH</strong>, click <strong>Set Path</strong> on MATLAB console and <strong>Add with Subfolders</strong>. See image below for what needs to be added</p>
<a class="reference internal image-reference" href="_images/MATLAB_paths.jpg"><img alt="_images/MATLAB_paths.jpg" class="align-center" src="_images/MATLAB_paths.jpg" style="width: 400.0px; height: 200.0px;" /></a>
</div>
<div class="section" id="how-to-run-existing-stimulus">
<h2>How to run existing stimulus<a class="headerlink" href="#how-to-run-existing-stimulus" title="Permalink to this headline">¶</a></h2>
<p>Unless you need to generate your own stimulus kind, you will simply run the exsiting stimulus.
Here, we will demonstrate how to run manually on your computer.
Note, when you actually run the experiment, you will do it through <strong>2p master</strong> MATLAB panel.
Below steps are, however, still useful when you generate your own stimulus and need to debug/troubleshoot.</p>
<div class="section" id="step-1-initialize-screen">
<h3>Step 1: Initialize screen<a class="headerlink" href="#step-1-initialize-screen" title="Permalink to this headline">¶</a></h3>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">stimulus</span><span class="p">.</span><span class="n">open</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="step-2-generate-stimulus-conditions-and-queue-trials">
<h3>Step 2: Generate stimulus conditions and queue trials<a class="headerlink" href="#step-2-generate-stimulus-conditions-and-queue-trials" title="Permalink to this headline">¶</a></h3>
<p>Stimulus trials are generated and queued by the scripts in the +stimulus/+conf directory. You need to know which configuration script needs to be run.</p>
<p>For example, to prepare the <strong>singledot</strong> stimulus, execute</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">stimulus</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">singledot</span>
</pre></div>
</td></tr></table></div>
<p>While the stimulus is loaded, you will see a sequence of dots . and asterisks <a href="#id2"><span class="problematic" id="id3">*</span></a>, which respectively indicate whether the conditions are computed anew or are loaded from the database.
Some stimuli take a long time to compute and you might like to run the configuration before you begin the experiment.
On subsequent runs, the computed stimuli will be loaded from the database and will not take as long.</p>
</div>
<div class="section" id="step-3-run-the-stimulus">
<h3>Step 3. Run the stimulus<a class="headerlink" href="#step-3-run-the-stimulus" title="Permalink to this headline">¶</a></h3>
<p>The stimulus must be run for a specific scan in the <cite>experiment.Scan</cite> table.
Table <cite>experiment.Scan</cite> contains a dummy entry that can be used for testing.
Its primary key is <cite>struct(‘animal_id’, 0, ‘session’, 0, ‘scan_idx’, 0)</cite>.
During the experiment, the correct scan identification must be provided.</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">stimulus</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;animal_id&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;session&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;scan_idx&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">false</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Note, <em>false</em> is given so that we <em>do not log</em> our dummy entries to <em>stimulus.Trial()</em> table.</p>
</div>
<div class="section" id="step-4-interrupt-and-resume-the-stimulus">
<h3>Step 4. Interrupt and resume the stimulus<a class="headerlink" href="#step-4-interrupt-and-resume-the-stimulus" title="Permalink to this headline">¶</a></h3>
<p>While the stimulus is playing, you can interrupt with <cite>Ctrl+c</cite>.
The stimulus program will handle this event, cancel the ongoing trial, and clear the screen.
To resume the stimulus, repeat the stimulus.run call above.
Or to queue a new set of trials, run the configuration script again.</p>
</div>
<div class="section" id="step-5-exit">
<h3>Step 5. Exit<a class="headerlink" href="#step-5-exit" title="Permalink to this headline">¶</a></h3>
<p>To close the stimulus program,</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">stimulus</span><span class="p">.</span><span class="n">close</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="stimulus-repository-structure">
<h2>Stimulus Repository Structure<a class="headerlink" href="#stimulus-repository-structure" title="Permalink to this headline">¶</a></h2>
<p>The structure of Stimulus repository can be confusing for new users and needs to be explained.
The basic structure can be broken down as the following tree:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>stimuli
├── python
└── matlab
  ├── +xtimulus
  ├── +imagenet
  ├── +netflix
  ├── conf
  |     ├── singledot.m
  |     ├── matisse.m
  |     ├── grating.m
  |     .
  |     .
  |     .
  └─── +stimulus
    ├── +conf
    |     ├── singledot.m
    |     ├── matisse.m
    |     ├── grating.m
    |     .
    |     .
    |     .
    ├── +core
    |      ├ Control.m
    |      ├ FIFO.m
    |      ├ Screen.m
    |      └ Visual.m
    ├── +utils
    |      ├ DataHash.m
    |      ├ factorize.m
    |      └ license.txt
    ├── SingleDot.m
    ├── Matisse.m
    ├── Grating.m
    .
    .
    .
</pre></div>
</div>
<p>We will only focus <cite>matlab</cite> folder.</p>
<p>Under <cite>matlab</cite> we have folders with <cite>+</cite> sign in front. For MATLAB, <cite>+</cite> has a special meaning and it recognizes as a class folder.
If you are familiar with Python, think <cite>+foldername</cite> as a <cite>module.py</cite>.
Inside these <cite>+foldername</cite>, you have bunch of <cite>m files</cite> and you can think of them as <cite>class</cite> definitions in Python.
If you need further help, you can refer to this <a class="reference external" href="https://www.mathworks.com/help/matlab/matlab_oop/organizing-classes-in-folders.html">MATLAB documentation</a>.</p>
<p>For those who are not familiar with Python nor classes, just treat them as a special symbol for MATLAB to recognize that folder and m files underneath</p>
<p>Let’s focus on <cite>+stimulus</cite> first. Inside <cite>+stimulus</cite>, we have <cite>+conf</cite>, <cite>+core</cite>, <cite>+utils</cite>, and whole bunch of m files:</p>
<blockquote>
<div><ul class="simple">
<li>+conf : contains configuration files (singledot.m, mattise.m, etc) that specify parameters for some stimulus display</li>
<li>+core : controls and interacts with your display and Psychtoolbox. Most likely, you won’t have to change anything here. But if you need to update something, consult with either Saumil or Dimitri</li>
<li>+utils: some help functions. Not so important unless you can find a function to be called universally across different stimuli.</li>
<li>m files (SingleDot.m, Matisse.m, etc): Display m files that dictate how the stimulus should be displayed.</li>
</ul>
</div></blockquote>
<p>Two important aspects here. First, right underneath <cite>+stimulus</cite>, <cite>SingleDot.m</cite> file, for example, dictates how the single dot stimulus is displayed.
We will go through this particular file in <cite>Designing a New Stimulus</cite> section and explain line by line.
Second aspect is <cite>singledot.m</cite> file underneath <cite>+stimulus/+conf/</cite>. These are configuration files that call WHICH stimulus to be displayed and set PARAMETERS for that particular stimulus.</p>
<p>Also, as you get more familiar/advanced with stimuli package, <cite>+core</cite> will become more important and you should spend time understand what each file (i.e. Visual, Screen, Control) does inside that class folder.</p>
<p>Notice that for DISPLAY file, we used <a class="reference external" href="https://en.wikipedia.org/wiki/Camel_case">camelCase</a> as naming convention.
For configuration file, we used lower case. Please keep these styles if you need to make new stimulus display and config files.</p>
<p>Now, you also notice that there is <cite>matlab/conf</cite> and <cite>matlab/+stimulus/+conf</cite>.
The reason we have TWO <cite>conf</cite> folders (with difference of <cite>+</cite> sign) is that for <cite>testing</cite> a new stimulus purpose, we put m files under <cite>matlab/+stimulus/+conf</cite>.
But when we actually scan, the finalized m file must be copied over to <cite>conf</cite> in your <cite>2pmaster</cite> scanning machine because 2pmaster only recognizes folders without <cite>+</cite> sign.</p>
<p>In other words, the same config file, for example, <cite>singledot.m</cite>, should exist in both <cite>matlab/conf</cite> and <cite>matlab/+stimulus/+conf</cite>.</p>
</div>
<div class="section" id="designing-a-new-stimulus">
<h2>Designing a New Stimulus<a class="headerlink" href="#designing-a-new-stimulus" title="Permalink to this headline">¶</a></h2>
<p>There are two parts in designing:</p>
<ol class="arabic simple">
<li>Stimulus Display - <cite>HOW</cite> the stimulus is displayed on the monitor/projector (e.g. SingleDot.m)</li>
<li>Stimulus Configuration - <cite>PARAMETERS</cite> for the stimulus one designed. (e.g. singledot.m)</li>
</ol>
<p>Often times, one doesn’t probably need to design a new stimulus display but simply modify the configuration file.</p>
<p>Here, we demonstrate a demo of designing a <cite>single dot</cite> stimulus</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/single_dot.gif"><img alt="_images/single_dot.gif" src="_images/single_dot.gif" style="width: 274.5px; height: 158.5px;" /></a>
<p class="caption"><span class="caption-text">single dot stimulus demo</span></p>
</div>
<div class="section" id="stimulus-display">
<h3>Stimulus Display<a class="headerlink" href="#stimulus-display" title="Permalink to this headline">¶</a></h3>
<p>Below is the content of <a class="reference external" href="https://github.com/cajal/stimuli/blob/master/matlab/%2Bstimulus/SingleDot.m">SingleDot.m</a>.</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">%{</span>
<span class="cm"># single dot to map receptive field</span>
<span class="cm">-&gt; stimulus.Condition</span>
<span class="cm">-----</span>
<span class="cm">bg_level                    : smallint                      # (0-255) the index of the background luminance, 0 is black</span>
<span class="cm">dot_level                   : smallint                      # (0-255) the index of the dot luminance, 0 is black</span>
<span class="cm">dot_x                       : float                         # (fraction of the x length, 0 for center, from -0.5 to 0.5) position of dot on x axis</span>
<span class="cm">dot_y                       : float                         # (fraction of the x length, 0 for center) position of dot on y axis</span>
<span class="cm">dot_xsize                   : float                         # (fraction of the x length) width of dots</span>
<span class="cm">dot_ysize                   : float                         # (fraction of the x length) height of dots</span>
<span class="cm">dot_shape                   : enum(&#39;rect&#39;,&#39;oval&#39;)           # shape of the dot</span>
<span class="cm">dot_time                    : float                         # (secs) time of each dot persists</span>
<span class="cm">%}</span>

<span class="k">classdef</span> <span class="n">SingleDot</span> <span class="o">&lt;</span> <span class="n">dj</span><span class="p">.</span><span class="n">Manual</span> <span class="o">&amp;</span> <span class="n">stimulus</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">Visual</span>
    <span class="k">properties</span><span class="p">(</span><span class="n">Constant</span><span class="p">)</span>
        <span class="n">version</span> <span class="p">=</span> <span class="s">&#39;2&#39;</span>
    <span class="k">end</span>

    <span class="k">methods</span>
<span class="k">        function</span><span class="w"> </span><span class="nf">showTrial</span><span class="p">(</span>self, cond<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">trialBacklogSize</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>  <span class="c">% see stimulus.core.Visual</span>
            <span class="n">Screen</span><span class="p">(</span><span class="s">&#39;FillRect&#39;</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">bg_level</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">width</span> <span class="p">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
            <span class="n">height</span> <span class="p">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
            <span class="n">x_pos</span> <span class="p">=</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
            <span class="n">y_pos</span> <span class="p">=</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">height</span><span class="o">/</span><span class="n">width</span><span class="p">;</span>
            <span class="n">rect</span> <span class="p">=</span> <span class="p">[</span><span class="n">x_pos</span><span class="o">-</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_xsize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">-</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_ysize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_pos</span><span class="o">+</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_xsize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">+</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_ysize</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>
            <span class="n">command</span> <span class="p">=</span> <span class="n">struct</span><span class="p">(</span><span class="s">&#39;rect&#39;</span><span class="p">,</span> <span class="s">&#39;FillRect&#39;</span><span class="p">,</span> <span class="s">&#39;oval&#39;</span><span class="p">,</span> <span class="s">&#39;FillOval&#39;</span><span class="p">);</span>
            <span class="n">Screen</span><span class="p">(</span><span class="n">command</span><span class="p">.(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_shape</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_level</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">flip</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;checkDroppedFrames&#39;</span><span class="p">,</span> <span class="n">false</span><span class="p">))</span>
            <span class="n">WaitSecs</span><span class="p">(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_time</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">fps</span><span class="p">);</span>
            <span class="n">Screen</span><span class="p">(</span><span class="n">command</span><span class="p">.(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_shape</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_level</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">flip</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;checkDroppedFrames&#39;</span><span class="p">,</span> <span class="n">false</span><span class="p">))</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
<p>First off, let’s start with the table defintion</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">%{</span>
<span class="cm"># single dot to map receptive field</span>
<span class="cm">-&gt; stimulus.Condition</span>
<span class="cm">-----</span>
<span class="cm">bg_level                    : smallint                      # (0-255) the index of the background luminance, 0 is black</span>
<span class="cm">dot_level                   : smallint                      # (0-255) the index of the dot luminance, 0 is black</span>
<span class="cm">dot_x                       : float                         # (fraction of the x length, 0 for center, from -0.5 to 0.5) position of dot on x axis</span>
<span class="cm">dot_y                       : float                         # (fraction of the x length, 0 for center) position of dot on y axis</span>
<span class="cm">dot_xsize                   : float                         # (fraction of the x length) width of dots</span>
<span class="cm">dot_ysize                   : float                         # (fraction of the x length) height of dots</span>
<span class="cm">dot_shape                   : enum(&#39;rect&#39;,&#39;oval&#39;)           # shape of the dot</span>
<span class="cm">dot_time                    : float                         # (secs) time of each dot persists</span>
<span class="cm">%}</span>
</pre></div>
</td></tr></table></div>
<p>If you are not familiar with datajoint MATLAB, refer to this <a class="reference external" href="https://docs.datajoint.io/matlab/">documentation</a>.</p>
<p>In this particular table, it inherits <cite>stimulus.Condition</cite> table as a <cite>primary attribute</cite>.
Then, it defines <cite>bg_level, dot_level, dot_x, dot_y, etc</cite>, in secondary attributes with specific datatype with explanations.
Make sure each attribute is properly explained when designing a table.</p>
<p>Now let’s look at the class itself:</p>
<div class="highlight-MATLAB"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">classdef</span> <span class="n">SingleDot</span> <span class="o">&lt;</span> <span class="n">dj</span><span class="p">.</span><span class="n">Manual</span> <span class="o">&amp;</span> <span class="n">stimulus</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">Visual</span>
    <span class="k">properties</span><span class="p">(</span><span class="n">Constant</span><span class="p">)</span>
        <span class="n">version</span> <span class="p">=</span> <span class="s">&#39;2&#39;</span>
    <span class="k">end</span>

    <span class="k">methods</span>
<span class="k">        function</span><span class="w"> </span><span class="nf">showTrial</span><span class="p">(</span>self, cond<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">trialBacklogSize</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>  <span class="c">% see stimulus.core.Visual</span>
            <span class="n">Screen</span><span class="p">(</span><span class="s">&#39;FillRect&#39;</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">bg_level</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">)</span>
            <span class="n">width</span> <span class="p">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
            <span class="n">height</span> <span class="p">=</span> <span class="n">self</span><span class="p">.</span><span class="n">rect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
            <span class="n">x_pos</span> <span class="p">=</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
            <span class="n">y_pos</span> <span class="p">=</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">height</span><span class="o">/</span><span class="n">width</span><span class="p">;</span>
            <span class="n">rect</span> <span class="p">=</span> <span class="p">[</span><span class="n">x_pos</span><span class="o">-</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_xsize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">-</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_ysize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_pos</span><span class="o">+</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_xsize</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">+</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_ysize</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>
            <span class="n">command</span> <span class="p">=</span> <span class="n">struct</span><span class="p">(</span><span class="s">&#39;rect&#39;</span><span class="p">,</span> <span class="s">&#39;FillRect&#39;</span><span class="p">,</span> <span class="s">&#39;oval&#39;</span><span class="p">,</span> <span class="s">&#39;FillOval&#39;</span><span class="p">);</span>
            <span class="n">Screen</span><span class="p">(</span><span class="n">command</span><span class="p">.(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_shape</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_level</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">flip</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;checkDroppedFrames&#39;</span><span class="p">,</span> <span class="n">false</span><span class="p">))</span>
            <span class="n">WaitSecs</span><span class="p">(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_time</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">/</span><span class="n">self</span><span class="p">.</span><span class="n">fps</span><span class="p">);</span>
            <span class="n">Screen</span><span class="p">(</span><span class="n">command</span><span class="p">.(</span><span class="n">cond</span><span class="p">.</span><span class="n">dot_shape</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">win</span><span class="p">,</span> <span class="n">cond</span><span class="p">.</span><span class="n">dot_level</span><span class="p">,</span> <span class="n">rect</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">flip</span><span class="p">(</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;checkDroppedFrames&#39;</span><span class="p">,</span> <span class="n">false</span><span class="p">))</span>
        <span class="k">end</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
<p>First, your class name must match with your filename (e.g. SingleDot). And it must inherit 2 additional classes, namely dj.Manual and stimulus.core.Visual (line 1).
To inherit in MATLAB, you use <cite>&lt;</cite> sign. By doing this, you declare that your table tier is <cite>Manual</cite>, and you now have access to <cite>Visual</cite> class.</p>
<p>We can set some properties and one of the properties that you MUST declare is <cite>version</cite> (line 2). <cite>version</cite> is an abstract property inherited from <a class="reference external" href="https://github.com/cajal/stimuli/blob/master/matlab/%2Bstimulus/%2Bcore/Visual.m#L11">Visual class</a>.</p>
<p>We can also set methods and <cite>showTrial</cite> (line 7) is another abstract method that is inherited from <a class="reference external" href="https://github.com/cajal/stimuli/blob/master/matlab/%2Bstimulus/%2Bcore/Visual.m#L70">Visual</a>. In other words, you MUST declare it, otherwise it will throw an error.</p>
<p>In line 8, we set <cite>self.trialBacklogSize = 100</cite></p>
</div>
</div>
<div class="section" id="stimulus-configuration">
<h2>Stimulus Configuration<a class="headerlink" href="#stimulus-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="imagenet-v2">
<h3>imagenet_v2<a class="headerlink" href="#imagenet-v2" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="other-resources">
<h2>Other Resources:<a class="headerlink" href="#other-resources" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">GitHub: <a class="reference external" href="https://github.com/cajal/stimuli.git">https://github.com/cajal/stimuli.git</a></div>
<div class="line">PsychToolbox Documentation: <a class="reference external" href="http://psychtoolbox.org/docs/Psychtoolbox">http://psychtoolbox.org/docs/Psychtoolbox</a></div>
<div class="line">PsychToolbox Demos: <a class="reference external" href="https://peterscarfe.com/ptbtutorials.html">https://peterscarfe.com/ptbtutorials.html</a></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="datajoint.html" class="btn btn-neutral float-left" title="DataJoint" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Synicix

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>